% =======================================================================
% Copyright 2022
% Author: Alex Hagen-Zanker
% University of Surrey
%
% Distributed under the MIT Licence (http://opensource.org/licenses/MIT)
% =======================================================================
%
clear variables; close all; clc
A1 = [0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 1 1 1 1 1 0 0 0; ...
      0 0 0 1 1 0 1 0 0 0; ...
      0 0 0 0 0 0 1 0 0 0; ...
      0 0 0 0 0 0 1 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0];

B1 = [0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 1 1 0; ...
      0 0 0 0 0 1 1 1 1 0; ...
      0 0 0 0 0 1 1 1 1 0; ...
      0 0 0 0 0 0 0 0 0 0];

A2 = [0 0 0 0 0 1 0 0 0 0; ...
      0 0 1 0 0 0 0 0 0 0; ...
      0 0 0 1 1 0 0 0 0 0; ...
      0 0 0 1 0 0 0 0 0 0; ...
      0 0 0 0 1 0 0 0 0 0; ...
      0 0 0 1 0 0 0 0 0 0; ...
      0 0 0 0 0 0 0 0 0 0; ...
      1 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 1 0 0 0 0 0; ...
      0 0 0 1 0 0 0 0 0 0];

B2 = [0 0 0 0 0 0 0 0 0 0; ...
      0 0 0 0 0 0 1 0 0 0; ...
      0 0 0 0 0 0 1 0 0 0; ...
      0 1 0 0 0 0 1 0 0 0; ...
      0 0 0 0 0 0 0 0 0 1; ...
      0 0 0 0 0 1 0 0 0 1; ...
      0 0 0 0 0 0 0 0 0 0; ...
      0 1 0 0 0 0 0 0 0 0; ...
      1 0 0 0 0 0 0 0 0 0; ...
      1 0 0 0 0 0 0 0 0 0];

Mask = ones(10);
M = eye(2);
f = @(d)(d <= 1.01) * 0.5 + (d <= 0.5) * 0.5;

[fk, sim, P, E] = fuzzy_kappa(A1, B1, M, Mask, f);
h          = subplot(2,3,1); imagesc(1-A1);title("A")
h(end + 1) = subplot(2,3,2); imagesc(1-B1);title("B")
h(end + 1) = subplot(2,3,3); imagesc(sim);
title("Sim (FK: " + fk + newline + "P: " + P + ", E: " + E + ")")

[fk, sim, P, E] = fuzzy_kappa(A2, B2, M, Mask, f);
h(end + 1) = subplot(2,3,4); imagesc(1-A2);title("A")
h(end + 1) = subplot(2,3,5); imagesc(1-B2);title("B")
h(end + 1) = subplot(2,3,6); imagesc(sim);
title("Sim (FK: " + fk + newline + "P: " + P + ", E: " + E + ")")


set(h, 'XTick', []);
set(h, 'YTick', []);
axis(h,'square')

colormap(gray)

